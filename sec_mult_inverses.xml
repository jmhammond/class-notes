<?xml version="1.0" encoding="UTF-8"?>
<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="section-multiplicative-inverses">
  <title>
    Multiplicative Inverses
  </title>

  <definition>
    <statement>
      <p>
        Let <m>a</m> be an integer and <m>m</m> a positive integer. We define a <term>multiplicative inverse of <m>a</m> modulo <m>m</m></term> to be an integer <m>b</m> such that <m>ab \equiv 1 \pmod{m}</m>.
      </p>
    </statement>
  </definition>

  <example>
    <statement>
      <p>
        Since <m>5\cdot 3 \equiv 1 \pmod{7}</m>, we say that <m>3</m> is a multiplicative inverse of 5 modulo 7. Similarly, 5 is a multiplicative inverse of 3 modulo 7.
      </p>
    </statement>
  </example>

  <p>
    One way in which we could determine the multiplicative inverse of a number <m>a</m> modulo <m>n</m> (if it exists), is to find every single multiple of those numbers modulo <m>n</m>. If we can find a number <m>b</m> so that <m>ab \equiv 1 \pmod{n}</m>, then we've found an inverse!
  </p>

  <example>
    <statement>
      <p>
        <ol>
          <li> 
            Find every multiple of 4 modulo 9.
          </li>
          <li>
            Find the inverse of 4 modulo 9.
          </li>
        </ol>
      </p>
    </statement>
    <solution>
      <p>
        Here's the multiplication table. Remember to reduce modulo 9. 
        <table>
          <title>Multiplication table of 4 modulo 9</title>
          <tabular halign="center">
            <row bottom="medium">
              <cell right="medium">
                *
              </cell>
              <cell>
                1
              </cell>
              <cell>
                2
              </cell>
              <cell>
                3
              </cell>
              <cell>
                4
              </cell>
              <cell>
                5
              </cell>
              <cell halign="left">
                6
              </cell>
              <cell halign="left">
                7
              </cell>
              <cell halign="left">
                8
              </cell>
              <cell halign="left">
                9
              </cell>
            </row>
            <row>
              <cell right="medium">
                4
              </cell>
              <cell>
                4
              </cell>
              <cell>
                8
              </cell>
              <cell>
                3
              </cell>
              <cell>
                7
              </cell>
              <cell>
                2
              </cell>
              <cell halign="left">
                6
              </cell>
              <cell halign="left">
                1
              </cell>
              <cell halign="left">
                5
              </cell>
              <cell halign="left">
                0
              </cell>
            </row>
          </tabular>
        </table>
      </p>
      <p>
        The inverse of 4 modulo 9 is 7. Why?
      </p>
    </solution>
  </example>


  <example>
    <statement>
      <p>
        Solve the congruence <m>4x = 5 \pmod 9 </m>.
      </p>
    </statement>
  </example>

  <example xml:id="multiplication-table">
    <statement>
      <p>
        Let's create a multiplication table modulo 9. The following Sage code does it for us. You can change the variable <c>n</c> to other numbers to quickly generate other multiplication tables.
      </p>
      <p>
        The output is a table/matrix whose <m>i, j</m>th entry is <m>i \cdot j \pmod \text{n}</m>.
        <sage>
          <input>
            n = 9
            rows = []
            for i in range(1, n):
            rows.append( map((lambda x: (i*x)%n), [x for x in range(1,n)]))

            table(rows)
          </input>
          <output>
            1	2	3	4	5	6	7	8
            2	4	6	8	1	3	5	7
            3	6	0	3	6	0	3	6
            4	8	3	7	2	6	1	5
            5	1	6	2	7	3	8	4
            6	3	0	6	3	0	6	3
            7	5	3	1	8	6	4	2
            8	7	6	5	4	3	2	1
          </output>
        </sage>

        <ol>
          <li> What is the inverse of 7 modulo 9? </li>
          <li> Does 6 have an inverse modulo 9? Why or why not?</li>
          <li> What numbers are invertible modulo 9? What numbers are not?</li>
        </ol>
      </p>
    </statement>
  </example>

  <p>
    The multiplication table might work for small values of <m>n</m>, but it is certainly tedious. We next introduce a way to determine an inverse procedurally.
  </p>

  <proposition>
    <statement>
      <p>
        If <m>a \and m</m> are relatively prime integers and <m>m \gt 1</m>, then an inverse of <m>a</m> modulo <m>m</m> exists.
      </p>
    </statement>
  </proposition>

  <note>
    <statement>
      <p>
        <ol>
          <li> The inverse of <m>a \text{ modulo } m</m> is its Bezout coefficient in <m>{\gcd(a,m) = as + mt}</m> </li>
          <li> The inverse is unique, but we won't prove that here.</li>
        </ol>
      </p>
    </statement>
  </note>

<example>
  <statement>
    <p>
      <ol>
        <li>
          Find the inverse of <m>6</m> modulo 29
        </li>
        <li>
          Use that inverse to solve the linear congruence <m>6x + 3 = 1 \pmod{29} </m>
        </li>
      </ol>
    </p>
  </statement>
</example>



  <exercises>
    <exercise>
      <statement>
        <p>
          Solve the congruence:
          <ol>
            <li><m> 3x + 4 = 7 \pmod 8 </m></li>
            <li><m> 9x = 4 \pmod{22}</m></li>
            <li><m> 5x + 14 = 0 \pmod{26}</m></li>
          </ol>
        </p>
      </statement>
    </exercise>


    <exercise>
      <statement>
        <p>
          Find all solutions to the congruence (there could be more than one):
          <ol>
            <li> <m>3x =6 \pmod 9 </m></li>
            <li> <m>4x = 3 \pmod 8 </m></li>
          </ol>
        </p>
      </statement>
    </exercise>


    <exercise>
      <statement>
        <p>
          Play around with making <xref ref="multiplication-table">multiplication tables of various moduli in the Sage code in example</xref>.
          <ol>
            <li> What condition is required for a number <m>a</m> to have an inverse modulo <m>n</m>? </li>
            <li> What is a condition on <m>n</m> for every element to have an inverse modulo <m>n</m>?</li>
          </ol>
        </p>
      </statement>
    </exercise>

  </exercises>

</section>
